# üõ∞Ô∏è AI-Driven Predictive Maintenance for OPS-SAT ADCS

## Autonomous ADCS Monitoring System for 3U CubeSats

### Project Overview

This repository features the development of a resilient, **AI-driven electronics subsystem** for the European Space Agency's (ESA) **OPS-SAT CubeSat**. The project's core mission is to create an **Autonomous Attitude Determination and Control System (ADCS) Monitoring System** that employs predictive maintenance algorithms to autonomously detect and correct anomalies while operating in space.

By running complex diagnostics directly on-board, the system significantly enhances mission resilience and reduces reliance on ground control, directly mitigating the high risk of failure often associated with CubeSat ADCS subsystems.

<p align="center">
  <img src="https://github.com/user-attachments/assets/a37d5b38-a686-4b0a-a191-43fa7d2d493b" width="100%">
</p>


## ‚ú® System Architecture and Key Features

The solution leverages a dual-AI approach optimized for low-power edge computing.

| Feature | Description |
| :--- | :--- |
| **Autonomous Anomaly Detection** | An **Artificial Neural Network (ANN)** model analyzes real-time sensor data to flag faults and deviations from normal operating conditions. |
| **Predictive Signal Correction** | Nine specialized **Random Forest models** are utilized‚Äîone for each monitored ADCS channel‚Äîto autonomously calculate and apply corrections to abnormal signals. |
| **Edge AI Optimization** | Models are deployed onto the **STM32F429** microcontroller for highly efficient, low-latency inference, respecting crucial **CubeSat constraints** (power, volume, radiation tolerance). |
| **Detection Performance** | The core ANN model validation yielded high results on the testing set: **95.65% Accuracy** and an **89.1% F1 Score**. |

<img width="3078" height="3234" alt="Design sans titre" src="https://github.com/user-attachments/assets/23293640-3e94-43c9-8125-23f23cf26113" />


---

## üìÇ Repository Structure
The project code and resources are logically separated into three major development areas: Machine Learning (ML), Data Processing, and Embedded Implementation.
```bash
‚îú‚îÄ‚îÄ ML_models(detection)    # Anomaly Detection (ANN) Model Notebooks and Training Data
‚îú‚îÄ‚îÄ ML_models(correction)   # Random Forest Correction Model Notebooks (Model1 to Model9)
‚îú‚îÄ‚îÄ edge_impulse            # Data Acquisition Scripts and Edge Impulse Project Configurations
‚îú‚îÄ‚îÄ STM32f429               # Final Embedded Firmware (High-Accuracy CubeAI & Edge Impulse Deployments)
‚îú‚îÄ‚îÄ schemaelectrique        # Electrical Schematics and Hardware Interface Design Files
‚îú‚îÄ‚îÄ .gitignore              # Specifies files and directories ignored by Git
‚îú‚îÄ‚îÄ LICENCE                 # Project's Proprietary License File
‚îî‚îÄ‚îÄ README.md               # Project overview, features, and setup instructions
```

I. Machine Learning Models
The ML subsystem is divided into two core functionalities for detection and correction, processing nine key ADCS data channels in total.

A. Anomaly Detection (ANN Model)
Directory: ML_models(detection)


Function: This primary model uses an Artificial Neural Network (ANN) to detect anomalies within the sensor readings in real-time. It is responsible for identifying faults in the satellite's attitude data stream.


Data Channels Monitored: Three magnetometer channels (X, Y, Z) and six photodiode channels (PD1-6).

Model Performance (Testing Set): The trained ANN model demonstrated high efficacy:


Accuracy: 95.65% 


F1 Score: 89.1% 


Area Under the Curve (AUC): 97.63% 

Model Footprint (Cortex-M4F): The model is optimized for edge deployment with minimal resources:


Total Latency: 2 ms 


RAM Usage: 0.2 KB 


Flash Usage: 34.7 KB 

B. Predictive Correction (Random Forest Models)
Directory: ML_models(correction)

Function: This layer ensures the autonomous integrity of the ADCS data. It consists of nine separate Random Forest models‚Äîone model dedicated to each of the nine monitored sensor channels.

Correction Logic: These models operate only after the ANN detects an anomaly. Their purpose is to predict and correct the abnormal signals, effectively mitigating minor faults independently of ground control.

II. Embedded Firmware (STM32F429)
The embedded repository contains the final, optimized code used for on-board processing and AI inference.

A. STM32F429 Firmware and Deployment
Directory: STM32f429


Processing Unit: The firmware targets the STM32F429 Discovery Kit, which features an Arm¬Æ Cortex¬Æ-M4 core microcontroller.

AI Deployment Strategy: This directory houses two distinct approaches to deploying the anomaly detection system:


CubeAI Framework (High Accuracy): This deployment leverages the highly optimized C-code generated by the STM32Cube.AI tool, integrating the high-accuracy ANN model directly into the embedded C/C++ firmware for efficient real-time inference.

Edge Impulse Framework (Lower Accuracy): This deployment is based on the framework from the edge_impulse folder and is used for comparative analysis or rapid prototyping, typically resulting in a less optimized, lower-accuracy model compared to the CubeAI version.

B. Hardware Context
The entire electronic subsystem is designed to meet strict CubeSat standards for power, volume, radiation tolerance, and thermal stability. The core components interfaced by the firmware include the STM32F429 Processing Unit, the MPU-9250 IMU, and the NanoCom AX100 (which simulates the communication motherboard).

III. Data Acquisition and Edge Impulse
Directory: edge_impulse

Function: This folder contains the tools and scripts necessary to utilize the Edge Impulse platform for feature engineering and comparative model training. It specifically holds:

Data Acquisition Scripts: Used to format and upload the raw ADCS telemetry data to the platform.

Processing Block (Feature Extraction): Defines the digital signal processing (DSP) or feature extraction pipeline applied to the raw sensor data before feeding it into the ML model.

Learning Block (NN Model): Defines the Neural Network architecture that is trained within the Edge Impulse platform, which results in the lower-accuracy embedded model.
---

## ‚öôÔ∏è Deployment and Development Tools

This project utilizes the following key tools and platforms:

* **Microcontroller:** STM32F429ZIT6 (Arm¬Æ Cortex¬Æ-M4)
* **Embedded IDE:** STM32CubeIDE
* **ML Frameworks:** TensorFlow/Keras, Scikit-learn, STM32Cube.AI, Edge Impulse

## üöÄ Getting Started

### Prerequisites

* Python 3.x
* Required ML libraries (e.g., NumPy, Pandas, Scikit-learn, TensorFlow/Keras)
* STM32CubeIDE (for embedded code compilation and flashing)
* Git

### ML Model Training

1.  Navigate to the ML directories:
    ```bash
    cd ML_models/OPS-SAT-NN/
    ```
2.  Run the notebooks (`dataset_generator.ipynb`) to process and prepare training data.
3.  Train and refine the ANN detection model.
4.  Navigate to the correction model folder to train the Random Forest models:
    ```bash
    cd correction_model/
    ```
5.  Run `model1.ipynb` through `model9.ipynb` to train the individual correction models.

### Embedded Deployment (Edge AI)

1.  Export the trained models (e.g., TFLite or C-code format).
2.  Open the project within the `STM32f429/Cube_AI/satellite_anomaly_detection_model/` directory using **STM32CubeIDE**.
3.  Compile and flash the code onto the **STM32F429 Discovery Kit** for real-time validation.

## ‚öôÔ∏è Core Technology

| Component | Role |
| :--- | :--- |
| **Microcontroller** | STM32F429ZIT6 (Arm¬Æ Cortex¬Æ-M4) |
| **Detection AI** | Artificial Neural Network (ANN) |
| **Correction AI** | 9 Random Forest Classifiers |
| **Sensors Monitored** | Magnetometer (3-axis) and Photodiodes (6 channels) |

## üìÑ License

This project is developed for the IEEE AESS Challenge (TSYP 13). All associated code and documentation rights are reserved by the authors and challenge rules.
